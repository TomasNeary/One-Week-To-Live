----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--
-- em_beacon
--
--
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

if isServer() then return; end;

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

print("[ Loading EM_BEACON ]");

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

em_beacon = {};

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

em_beacon.doRelay = function(_beacon, _icon, _channel, _range)
	local ID = _icon.username.."-".._channel;
	if _beacon.txlist[ID] then
		return false;
	else
		_beacon.txlist[ID] = true;
		_beacon.range = _range;
		_beacon.origin.x = _icon.x;
		_beacon.origin.y = _icon.y;
		return true;
	end;
end

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

function em_beacon:new(_icon, _channel, _range)
	local o = {};
	setmetatable(o, self);

	o.txlist = {};

	o.range = _range;

	o.origin = {
		x = _icon.x,
		y = _icon.y,
	};

	o.age = getGameTime():getWorldAgeHours();

	o.beaconID = _icon.username.."-".._channel;

	o.txlist[o.beaconID] = true;

	o.channel = _channel;

	o.iconData = _icon.iconData .. " on " .. (_channel / 1000) .. " MHz";
	o.iconDataExt = _icon.iconDataExt;

	o.x = _icon.x;
	o.y = _icon.y;

	o.r = _icon.r;
	o.g = _icon.g;
	o.b = _icon.b;
	o.a = 1;

	return o;
end

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------